<!DOCTYPE html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    
    
        <meta name="referrer" content="no-referrer"/>
    



<meta name="twitter:title" content="ASP.net Core 的RESTful应用"/>
<meta name="twitter:description" content=".tabset mean tabs."/>
<meta name="twitter:site" content="@"/>



  	<meta property="og:title" content="ASP.net Core 的RESTful应用 &middot; 迁移自(cnblogs.com/xiaobin-hlj80)" />
  	<meta property="og:site_name" content="迁移自(cnblogs.com/xiaobin-hlj80)" />
  	<meta property="og:url" content="https://tdtc-hrb.github.io/cnblogs2/post/asp.net6-restful/" />

    
        
    

    
    <meta property="og:description" content=".tabset mean tabs." />
  	<meta property="og:type" content="article" />
    <meta property="article:published_time" content="2021-11-11T12:38:08&#43;08:00" />

    
    

    <title>ASP.net Core 的RESTful应用 &middot; 迁移自(cnblogs.com/xiaobin-hlj80)</title>

    
    <meta name="description" content=".tabset mean tabs." />
    

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="/cnblogs2/images/favicon.ico">
	  <link rel="apple-touch-icon" href="/cnblogs2/images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="/cnblogs2/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="/cnblogs2/css/nav.css" />

    

    

    
      
          <link href="/cnblogs2/index.xml" rel="alternate" type="application/rss+xml" title="迁移自(cnblogs.com/xiaobin-hlj80)" />
      
      
    
    <meta name="generator" content="Hugo 0.145.0">

    <link rel="canonical" href="https://tdtc-hrb.github.io/cnblogs2/post/asp.net6-restful/" />

    
      
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name":  null 
    },
    "author": {
        "@type": "Person",
        "name":  null ,
        
        "url":  null ,
        "sameAs": [
            
            
             
             
             
             
             
            
        ]
    },
    "headline": "ASP.net Core 的RESTful应用",
    "name": "ASP.net Core 的RESTful应用",
    "wordCount":  545 ,
    "timeRequired": "PT3M",
    "inLanguage": {
      "@type": "Language",
      "alternateName": "en"
    },
    "url": "https://tdtc-hrb.github.io/cnblogs2/post/asp.net6-restful/",
    "datePublished": "2021-11-11T12:38Z",
    "dateModified": "2021-11-11T12:38Z",
    
    
    "description": ".tabset mean tabs.",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://tdtc-hrb.github.io/cnblogs2/post/asp.net6-restful/"
    }
}
    </script>
    


    

    

    
</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
    </ul>

    
    <a class="subscribe-button icon-feed" href="/cnblogs2/index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">



<header class="main-header post-head no-cover">
  <nav class="main-nav clearfix">


  
  
      <a class="menu-button icon-feed" href="/cnblogs2/index.xml" >&nbsp;&nbsp;Subscribe</a>
  
  </nav>
</header>



<main class="content" role="main">




  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">ASP.net Core 的RESTful应用</h1>
        <small>.tabset mean tabs.</small>

        <section class="post-meta">
        
          <time class="post-date" datetime="2021-11-11T12:38:08&#43;08:00">
            Nov 11, 2021
          </time>
        
         
        </section>
    </header>

    <section class="post-content">
      <p>使用Scaffolder模板创建api。</p>
<ul>
<li>PowerShell v5.1</li>
<li>IDE: Visual Studio Code/<a href="https://docs.microsoft.com/en-us/visualstudio/releases/2022/release-notes">Visual Studio 2022</a></li>
<li>NuGet</li>
</ul>
<blockquote>
<p>..\AppData\Roaming\NuGet\NuGet.Config</p></blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;packageSources&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;add</span> <span style="color:#a6e22e">key=</span><span style="color:#e6db74">&#34;api.nuget.org&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;https://api.nuget.org/v3/index.json&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/packageSources&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/configuration&gt;</span>
</span></span></code></pre></div><h1 id="create-project">Create Project</h1>
<p>vs code</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dotnet new webapi -o MyWebApp --package Swashbuckle.AspNetCore:PackageVersion<span style="color:#f92672">=</span>6.2.3
</span></span></code></pre></div><h3 id="add-nuget-package">add NuGet package</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dotnet add package Microsoft.EntityFrameworkCore
</span></span><span style="display:flex;"><span>dotnet add package MySql.EntityFrameworkCore
</span></span><span style="display:flex;"><span>dotnet add package Microsoft.EntityFrameworkCore.Tools
</span></span></code></pre></div><h3 id="option-nuget-package">Option NuGet package</h3>
<p>Pomelo:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>CLI&gt; dotnet add package Pomelo.EntityFrameworkCore.MySql
</span></span></code></pre></div><h2 id="test">Test</h2>
<p><a href="https://localhost:5001/swagger/index.html">Browser</a></p>
<h1 id="models">Models</h1>
<p>建立Entity类：Supplier、Product、Category</p>
<h2 id="dbcontext">DbContext</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>public class StorageBuyDbContext : DbContext
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    public StorageBuyDbContext<span style="color:#f92672">(</span>DbContextOptions&lt;StorageBuyDbContext&gt; options<span style="color:#f92672">)</span> : base<span style="color:#f92672">(</span>options<span style="color:#f92672">){}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    public DbSet&lt;Category&gt; Categories <span style="color:#f92672">{</span> get; set; <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    public DbSet&lt;Supplier&gt; Suppliers <span style="color:#f92672">{</span> get; set; <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    public DbSet&lt;Product&gt; Products <span style="color:#f92672">{</span> get; set; <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h2 id="add-service">add service</h2>
<h3 id="add-connectiong-string">add connectiong string</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>&#34;Data&#34;: {
</span></span><span style="display:flex;"><span>  &#34;StorageBuy&#34;: {
</span></span><span style="display:flex;"><span>    &#34;ConnectionString&#34;: &#34;server=127.0.0.1; user id=DBAdmin; password=xbfirst; database=storagebuy; pooling=false; Convert Zero Datetime=True;&#34;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="add-mysql">add mysql</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>services.AddDbContext&lt;StorageBuyDbContext&gt;<span style="color:#f92672">(</span>options <span style="color:#f92672">=</span>&gt;
</span></span><span style="display:flex;"><span>    options.UseMySQL<span style="color:#f92672">(</span>Configuration<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;Data:StorageBuy:ConnectionString&#34;</span><span style="color:#f92672">])</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">)</span>;
</span></span></code></pre></div><h1 id="数据表">数据表</h1>
<p>install ef-tool</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dotnet tool install --global dotnet-ef
</span></span></code></pre></div><h2 id="生成db执行文件">生成db执行文件</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dotnet ef migrations add Initial
</span></span></code></pre></div><h2 id="生成table">生成Table</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dotnet ef database update
</span></span></code></pre></div><h2 id="写入数据">写入数据</h2>
<p>seedData.cs</p>
<h2 id="exec">exec</h2>
<blockquote>
<p>Startup.cs</p>
<blockquote>
<p>Configure方法中</p></blockquote></blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>SeedData.EnsurePopulated<span style="color:#f92672">(</span>app<span style="color:#f92672">)</span>;
</span></span></code></pre></div><p><a href="https://pan.baidu.com/s/1zX1TVAe_NONChAAGNp7k-w">Part I</a>  提取码: mmig</p>
<h1 id="建立mcj">建立MC<sub>j</sub></h1>
<h2 id="建立controller">建立Controller</h2>
<p>使用VS 2022 Scaffolder模板:
<img src="https://gitee.com/xiaobin80/cnblogs/raw/master/images/202110283000732.png" alt="VS2022 prj1"></p>
<p><img src="https://gitee.com/xiaobin80/cnblogs/raw/master/images/202110280005040.png" alt="vs2022 pre2"></p>
<h3 id="配置路由">配置路由</h3>
<ul>
<li>class</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>ApiController<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Route<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;api/[controller]&#34;</span><span style="color:#f92672">)]</span>
</span></span></code></pre></div><ul>
<li>method <br>
以Get举例:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>HttpGet<span style="color:#f92672">]</span>
</span></span></code></pre></div><h3 id="处理data">处理Data</h3>
<p>所有数据:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#66d9ef">return</span> await _context.Products.ToListAsync<span style="color:#f92672">()</span>;
</span></span></code></pre></div><p>指定数据:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>var product <span style="color:#f92672">=</span> await _context.Products.FindAsync<span style="color:#f92672">(</span>id<span style="color:#f92672">)</span>;
</span></span></code></pre></div><h2 id="配置json">配置Json</h2>
<p>忽略空值</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>services.Configure&lt;JsonOptions&gt;<span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>    opts <span style="color:#f92672">=</span>&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        opts.JsonSerializerOptions.IgnoreNullValues <span style="color:#f92672">=</span> true;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">)</span>;
</span></span></code></pre></div><h1 id="commit-operator">commit operator</h1>
<p>指定操作方式(Table 3-1), 并指定源<sup>1</sup>(Table 3-2). <br>
推荐使用<a href="https://www.postman.com/downloads/">PostMan</a>来进行调试.</p>
<p>Table 3-1. <a href="https://restfulapi.net/http-methods/">HTTP Methods and Operations</a></p>
<table>
  <thead>
      <tr>
          <th>HTTP</th>
          <th>Method Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>GET</td>
          <td>从服务器获取数据</td>
      </tr>
      <tr>
          <td>POST</td>
          <td>向服务器提交新的Object</td>
      </tr>
      <tr>
          <td>PUT</td>
          <td>向服务器提交修改(整体)</td>
      </tr>
      <tr>
          <td>DELETE</td>
          <td>向服务器提交删除object.</td>
      </tr>
      <tr>
          <td>PATCH</td>
          <td>向服务器提交更新部分object.</td>
      </tr>
  </tbody>
</table>
<p>Table 3-2. 源属性</p>
<table>
  <thead>
      <tr>
          <th>Name</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.fromqueryattribute">FromQuery</a></td>
          <td>Gets values from the query string.</td>
      </tr>
      <tr>
          <td><a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.fromrouteattribute">FromRoute</a></td>
          <td>Gets values from route data.</td>
      </tr>
      <tr>
          <td><a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.fromformattribute">FromForm</a></td>
          <td>Gets values from posted form fields.</td>
      </tr>
      <tr>
          <td><a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.frombodyattribute">FromBody</a></td>
          <td>Gets values from the request body.</td>
      </tr>
      <tr>
          <td><a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.fromheaderattribute">FromHeader</a></td>
          <td>Gets values from HTTP headers.</td>
      </tr>
  </tbody>
</table>
<h2 id="putpostdelete">PUT/POST/DELETE</h2>
<ul>
<li>更新</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>_context.Entry<span style="color:#f92672">(</span>product<span style="color:#f92672">)</span>.State <span style="color:#f92672">=</span> EntityState.Modified;
</span></span></code></pre></div><ul>
<li>添加</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>_context.Products.Add<span style="color:#f92672">(</span>product<span style="color:#f92672">)</span>;
</span></span></code></pre></div><ul>
<li>移出</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>_context.Products.Remove<span style="color:#f92672">(</span>product<span style="color:#f92672">)</span>;
</span></span></code></pre></div><h2 class="tabset" id="patch">Patch</h2>
<p>在客户端patch时的操作码见Table3-3</p>
<p>Table 3-3. httpPatch操作码</p>
<table>
  <thead>
      <tr>
          <th>Operation</th>
          <th>Notes</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>add</td>
          <td>Add a property or array element. For existing property: set value.</td>
      </tr>
      <tr>
          <td>remove</td>
          <td>Remove a property or array element.</td>
      </tr>
      <tr>
          <td>replace</td>
          <td>Same as remove followed by add at same location.</td>
      </tr>
      <tr>
          <td>move</td>
          <td>Same as remove from source followed by add to destination using value from source.</td>
      </tr>
      <tr>
          <td>copy</td>
          <td>Same as add to destination using value from source.</td>
      </tr>
      <tr>
          <td>test</td>
          <td>Return success status code if value at path = provided value.</td>
      </tr>
  </tbody>
</table>
<h3 id="pm">PM</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Install-Package Microsoft.AspNetCore.Mvc.NewtonsoftJson
</span></span></code></pre></div><h3 id="cli">CLI</h3>
<pre tabindex="0"><code>dotnet add package Microsoft.AspNetCore.Mvc.NewtonsoftJson
</code></pre><h2 id="config">config</h2>
<blockquote>
<p>Startup</p></blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>            services.AddControllers<span style="color:#f92672">()</span>.AddNewtonsoftJson<span style="color:#f92672">()</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            services.Configure&lt;MvcNewtonsoftJsonOptions&gt;<span style="color:#f92672">(</span>opts <span style="color:#f92672">=</span>&gt; <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                opts.SerializerSettings.NullValueHandling
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">=</span> Newtonsoft.Json.NullValueHandling.Ignore;
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">})</span>;
</span></span></code></pre></div><h2 id="enjoin-parameter">enjoin parameter</h2>
<p>需要指定从哪里获取JSON, 普遍是<a href="https://docs.microsoft.com/zh-cn/aspnet/core/mvc/models/model-binding?view=aspnetcore-5.0#sources">FromBody</a>,并用JsonPatchDocument<T>解析JSON, 最后在方法里使用ApplyTo<sup>2</sup></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ModifyProduct<span style="color:#f92672">(</span>long id, <span style="color:#f92672">[</span>FromBody<span style="color:#f92672">]</span> JsonPatchDocument&lt;Product&gt; patchDoc<span style="color:#f92672">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>patchDoc.ApplyTo<span style="color:#f92672">(</span>product<span style="color:#f92672">)</span>;
</span></span></code></pre></div><h2 id="patch-method">patch method</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#a6e22e">        [HttpPatch(&#34;{id}&#34;)]</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">async</span> Task&lt;IActionResult&gt; ModifyProduct(<span style="color:#66d9ef">long</span> id, [FromBody] JsonPatchDocument&lt;Product&gt; patchDoc)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> product = <span style="color:#66d9ef">await</span> _context.Products.FindAsync(id);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (product != <span style="color:#66d9ef">null</span>)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                patchDoc.ApplyTo(product);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">await</span> _context.SaveChangesAsync();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> Ok();
</span></span><span style="display:flex;"><span>        }
</span></span></code></pre></div><h2 id="test-data">Test Data</h2>
<blockquote>
<p>PowerShell</p></blockquote>
<h3 id="get">get</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Invoke-WebRequest https://localhost:7255/api/products/1 | Select-Object Content
</span></span></code></pre></div><h3 id="post">post</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Invoke-RestMethod https://localhost:7255/api/products -Method POST -Body <span style="color:#f92672">(</span>@<span style="color:#f92672">{</span> Name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Swimming Goggles&#34;</span>;
</span></span><span style="display:flex;"><span>Price<span style="color:#f92672">=</span>12.75; Category_id<span style="color:#f92672">=</span>1; Supplier_id<span style="color:#f92672">=</span>1<span style="color:#f92672">}</span> | ConvertTo-Json<span style="color:#f92672">)</span> -ContentType <span style="color:#e6db74">&#34;application/json&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Invoke-RestMethod https://localhost:7255/api/products -Method POST -Body <span style="color:#f92672">(</span>@<span style="color:#f92672">{</span> Name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Soccer Boots&#34;</span>; Price<span style="color:#f92672">=</span>89.99;
</span></span><span style="display:flex;"><span>Category_id<span style="color:#f92672">=</span>2; Supplier_id<span style="color:#f92672">=</span>2<span style="color:#f92672">}</span> | ConvertTo-Json<span style="color:#f92672">)</span> -ContentType <span style="color:#e6db74">&#34;application/json&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Invoke-RestMethod https://localhost:7255/api/products -Method POST -Body <span style="color:#f92672">(</span>@<span style="color:#f92672">{</span> Name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Swim Buoy&#34;</span>;
</span></span><span style="display:flex;"><span>Price<span style="color:#f92672">=</span>19.99; Category_id<span style="color:#f92672">=</span>1; Supplier_id<span style="color:#f92672">=</span>1<span style="color:#f92672">}</span> | ConvertTo-Json<span style="color:#f92672">)</span> -ContentType <span style="color:#e6db74">&#34;application/json&#34;</span>
</span></span></code></pre></div><h3 id="update">update</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Invoke-RestMethod https://localhost:7255/api/products/1 -Method PUT -Body <span style="color:#f92672">(</span>@<span style="color:#f92672">{</span> Id<span style="color:#f92672">=</span>1; Name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Green Kayak&#34;</span>;
</span></span><span style="display:flex;"><span>Price<span style="color:#f92672">=</span>275; Category_id<span style="color:#f92672">=</span>1; Supplier_id<span style="color:#f92672">=</span>1<span style="color:#f92672">}</span> | ConvertTo-Json<span style="color:#f92672">)</span> -ContentType <span style="color:#e6db74">&#34;application/json&#34;</span>
</span></span></code></pre></div><h3 id="delete">delete</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Invoke-RestMethod https://localhost:7255/api/products/12 -Method DELETE
</span></span></code></pre></div><h3 id="status-code">status code</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Invoke-WebRequest https://localhost:7255/api/products/100 |Select-Object StatusCode
</span></span></code></pre></div><h3 id="patch-1">patch</h3>
<blockquote>
<p>allow tls1.2<sup>4</sup></p></blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ps" data-lang="ps"><span style="display:flex;"><span>[<span style="color:#a6e22e">Net.ServicePointManager</span>]<span style="color:#a6e22e">::SecurityProtocol</span> <span style="color:#a6e22e">=</span> [<span style="color:#a6e22e">Net.SecurityProtocolType</span>]<span style="color:#a6e22e">::Tls12</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Invoke-RestMethod https://localhost:7255/api/products/1 -Method PATCH -Body <span style="color:#e6db74">&#39;[{&#34;op&#34;:&#34;replace&#34;, &#34;path&#34;:&#34;Price&#34;, &#34;value&#34;:&#34;618.00&#34;}]&#39;</span> -ContentType <span style="color:#e6db74">&#34;application/json&#34;</span>
</span></span></code></pre></div><p><a href="https://pan.baidu.com/s/1g1xXeNC1ootHACUopvRIwg">MyWebApp v6.0</a> 提取码: tocx</p>
<h1 id="reference">Reference</h1>
<ul>
<li><a href="https://docs.microsoft.com/en-us/aspnet/core/mvc/models/model-binding?view=aspnetcore-5.0#sources"><sup>1</sup> Sources</a></li>
<li><a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.jsonpatch.jsonpatchdocument?view=aspnetcore-5.0"><sup>2</sup> JsonPatchDocument</a></li>
<li><a href="https://docs.microsoft.com/en-us/aspnet/core/web-api/jsonpatch?view=aspnetcore-5.0#operations"><sup>3</sup> Operations</a></li>
<li><a href="https://evotec.xyz/invoke-restmethod-the-underlying-connection-was-closed-an-unexpected-error-occurred-on-a-send-while-connecting-graph-api/"><sup>4</sup> Invoke-RestMethod : The underlying connection was closed: The connection was closed unexpectedly</a></li>
<li><a href="https://stackoverflow.com/questions/10113244/why-use-icollection-and-not-ienumerable-or-listt-on-many-many-one-many-relatio">Why use ICollection and not IEnumerable or List<T> on many-many/one-many relationships?</a></li>
<li><a href="https://www.cosmiclearn.com/dotnet/aspnet_webapi_httppost.php">ASP.NET CORE HTTPPOST - CREATE</a></li>
<li><a href="https://www.cnblogs.com/KQNLL/p/10322143.html">.net core 中的FromBody</a></li>
<li><a href="https://docs.microsoft.com/zh-cn/aspnet/core/web-api/jsonpatch?view=aspnetcore-5.0#json-patch-in-aspnet-core">ASP.NET Core 中的 JSON Patch</a></li>
<li><a href="https://stackoverflow.com/questions/58346617/unable-to-connect-to-web-server-iis-express">Unable to connect to web server &lsquo;IIS Express&rsquo;</a> <br>
删除.vs文件夹即可</li>
</ul>

    </section>


  <footer class="post-footer">


    




    
<section class="share">
  <h4>Share this post</h4>
  <a class="icon-twitter" style="font-size: 1.4em" href="https://twitter.com/share?text=ASP.net%20Core%20%e7%9a%84RESTful%e5%ba%94%e7%94%a8&nbsp;-&nbsp;%e8%bf%81%e7%a7%bb%e8%87%aa%28cnblogs.com%2fxiaobin-hlj80%29&amp;url=https%3a%2f%2ftdtc-hrb.github.io%2fcnblogs2%2fpost%2fasp.net6-restful%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
      <span class="hidden">Twitter</span>
  </a>
  <a class="icon-facebook" style="font-size: 1.4em" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftdtc-hrb.github.io%2fcnblogs2%2fpost%2fasp.net6-restful%2f"
      onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
      <span class="hidden">Facebook</span>
  </a>
  <a class="icon-pinterest" style="font-size: 1.4em" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftdtc-hrb.github.io%2fcnblogs2%2fpost%2fasp.net6-restful%2f&amp;description=ASP.net%20Core%20%e7%9a%84RESTful%e5%ba%94%e7%94%a8"
      onclick="window.open(this.href, 'pinterest-share','width=580,height=296');return false;">
      <span class="hidden">Pinterest</span>
  </a>
  <a class="icon-google-plus" style="font-size: 1.4em" href="https://plus.google.com/share?url=https%3a%2f%2ftdtc-hrb.github.io%2fcnblogs2%2fpost%2fasp.net6-restful%2f"
     onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
      <span class="hidden">Google+</span>
  </a>
</section>



    







  </footer>
</article>

</main>


  <aside class="read-next">
  
      <a class="read-next-story" style="no-cover" href="/cnblogs2/post/sqlite.net.core/">
          <section class="post">
              <h2>SQLite在.net core的demo</h2>
              
          </section>
      </a>
  
  
      <a class="read-next-story prev" style="no-cover" href="/cnblogs2/post/asp.net6-grpc/">
          <section class="post">
              <h2>ASP.net Core 的gRPC Service应用</h2>
          </section>
      </a>
  
</aside>



    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">迁移自(cnblogs.com/xiaobin-hlj80)</a> </section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="/cnblogs2/js/jquery.js"></script>
    <script type="text/javascript" src="/cnblogs2/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/cnblogs2/js/index.js"></script>
    
</body>
</html>

